prometheus.remote_write "staging" {
  endpoint {
    url = "http://10.10.25.156/api/v1/write"

    http_client_config {
      basic_auth {
        username = "admin"
        password = "admin"
      }
    }
  }
}

prometheus.scrape "demo1" {
  targets = [
    {"__address__" = "localhost:12345", "instance" = "test"},
  ]

  forward_to = [prometheus.remote_write.staging.receiver]

  scrape_interval = "60s"
  scrape_timeout = "60s"
  params          = { "target" = ["172.30.11.6"], "module" = ["bk_switch_118435544b6c4795a983e4d5a3c19a66"], "walk_params" = ["bk_switch@@深圳测试环境交换机@@9915"] }
  metrics_path    = "/integrations/snmp/metrics"
}

logging {
  level  = "debug"
  format = "logfmt"
}

EXPERIMENTAL_ENABLE_FLOW=1 grafana-agent run test --server.http.listen-addr "0.0.0.0:1234"